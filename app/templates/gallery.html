{% extends "layout.html" %}

{% block content %}
<div class="gallery-container">
    <div class="gallery-header">
        <div>
            <h1>Gallery</h1>
            <p>Explore the latest uploads</p>
        </div>
    </div>

    <form action="{{ url_for('web.gallery') }}" method="GET" class="search-form">
        <div class="search-input-wrapper">
            <i class="fa-solid fa-magnifying-glass search-icon"></i>
            <input type="text" name="search" placeholder="Search videos..." value="{{ request.args.get('search', '') }}" autocomplete="off">
        </div>
    </form>

    <div class="video-grid">
        {% for video in videos %}
        <a href="{{ url_for('web.watch', video_id=video.video_id) }}" class="video-card">
            <div class="thumbnail-wrapper">
                {% if video.thumbnail %}
                    <img src="{{ url_for('stream.stream_file', filename=video.thumbnail) }}" alt="{{ video.title }}" loading="lazy">
                {% else %}
                    <div class="no-thumb"><i class="fa-solid fa-play"></i></div>
                {% endif %}
            </div>

            <div class="video-info">
                <h3 class="video-title" title="{{ video.title }}">{{ video.title }}</h3>
                <div class="secondary-info">
                    <p class="channel-name">SnapStream User</p>
                    <div class="video-stats">
                        <span>Uploaded {{ video.created_at[:10] }}</span>
                    </div>
                </div>
            </div>
        </a>
        {% else %}
            <div class="empty-state">
                <div class="empty-icon"><i class="fa-solid fa-film"></i></div>
                <h3>No videos found</h3>
                <p>We couldn't find any videos matching your search.</p>
                <a href="{{ url_for('web.gallery') }}" class="btn-reset">Clear Search</a>
            </div>
        {% endfor %}
    </div>
</div>

<style>
    .gallery-container { padding: 2rem; max-width: 1800px; margin: 0 auto; }
    .gallery-header { margin-bottom: 1.5rem; }
    .gallery-header h1 { font-size: 1.8rem; color: white; margin-bottom: 4px; }
    .gallery-header p { color: #aaa; font-size: 0.9rem; }

    .search-form { margin-bottom: 2rem; max-width: 600px; }
    .search-input-wrapper { position: relative; background: #1a1a1a; border-radius: 24px; border: 1px solid #333; overflow: hidden; transition: border-color 0.2s; }
    .search-input-wrapper:focus-within { border-color: #3b82f6; }
    .search-icon { position: absolute; left: 16px; top: 50%; transform: translateY(-50%); color: #777; }
    .search-input-wrapper input { width: 100%; background: transparent; border: none; padding: 12px 16px 12px 44px; color: white; outline: none; font-size: 1rem; }

    .video-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 24px 20px; }
    .video-card { display: flex; flex-direction: column; text-decoration: none; cursor: pointer; border-radius: 12px; overflow: hidden; transition: transform 0.2s; }
    
    .thumbnail-wrapper { position: relative; width: 100%; aspect-ratio: 16/9; border-radius: 12px; overflow: hidden; background: #0f0f0f; }
    .thumbnail-wrapper img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s ease; }
    .video-card:hover img { transform: scale(1.03); }
    .no-thumb { width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; background: #1a1a1a; color: #333; font-size: 3rem; }

    .video-info { display: flex; flex-direction: column; gap: 6px; padding: 16px 12px 8px 12px; }
    .video-title { margin: 0 0 4px 0; color: white; font-weight: 600; line-height: 1.5rem; font-size: 1.1rem; text-align: center; max-height: 3rem; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; text-overflow: ellipsis; }
    .video-card:hover .video-title { color: #3b82f6; }

    .secondary-info { color: #aaa; font-size: 0.85rem; line-height: 1.3; text-align: left; width: 100%; }
    .channel-name { margin: 0 0 2px 0; font-weight: 500; }
    .video-stats { color: #777; font-size: 0.8rem; }

    .empty-state { grid-column: 1 / -1; text-align: center; padding: 6rem 2rem; color: #777; }
    .empty-icon { font-size: 4rem; margin-bottom: 1rem; opacity: 0.7; }
    .empty-state h3 { color: white; margin-bottom: 0.5rem; font-size: 1.5rem; }
    .btn-reset { display: inline-block; margin-top: 1rem; color: #3b82f6; text-decoration: none; font-weight: 600; }
</style>
{% endblock %}